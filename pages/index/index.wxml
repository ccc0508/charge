<!--pages/index/index.wxml-->

<!-- é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ -->
<view class="header">
  <view class="header-top">
    <view class="month-title">{{currentYear}}å¹´{{currentMonth}}æœˆ</view>
    <view class="stats-btn" bindtap="goToStats">ğŸ“Š ç»Ÿè®¡</view>
  </view>
  <view class="summary-cards">
    <view class="card card-income">
      <text class="card-label">æ”¶å…¥</text>
      <text class="card-amount">{{summary.income}}</text>
    </view>
    <view class="card card-expense">
      <text class="card-label">æ”¯å‡º</text>
      <text class="card-amount">{{summary.expense}}</text>
    </view>
    <view class="card card-balance">
      <text class="card-label">ç»“ä½™</text>
      <text class="card-amount">{{summary.balance}}</text>
    </view>
  </view>
</view>

<!-- è®°å½•åˆ—è¡¨ -->
<view class="record-list">
  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{isEmpty}}" class="empty-state">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— è®°å½•ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹è®°è´¦å§</text>
  </view>

  <!-- æŒ‰æ—¥æœŸåˆ†ç»„ -->
  <view wx:for="{{groupedRecords}}" wx:key="date" class="date-group">
    <view class="date-header">
      <text class="date-label">{{item.dateLabel}}</text>
    </view>

    <view
      wx:for="{{item.records}}"
      wx:for-item="record"
      wx:key="id"
      class="swipe-wrapper"
    >
      <view
        class="record-item"
        style="transform: translateX({{record.swipeOffset || 0}}px);"
        data-id="{{record.id}}"
        data-gidx="{{index}}"
        data-ridx="{{index}}"
        catchtouchstart="onTouchStart"
        catchtouchmove="onTouchMove"
        catchtouchend="onTouchEnd"
      >
        <view class="record-left">
          <text class="record-icon">{{record.categoryIcon}}</text>
          <view class="record-info">
            <text class="record-category">{{record.categoryLabel}}</text>
            <text wx:if="{{record.note}}" class="record-note">{{record.note}}</text>
          </view>
        </view>
        <text class="record-amount {{record.isIncome ? 'amount-income' : 'amount-expense'}}">
          {{record.amountText}}
        </text>
      </view>
      <view class="delete-btn" data-id="{{record.id}}" bindtap="onDeleteRecord">
        <text>åˆ é™¤</text>
      </view>
    </view>
  </view>
</view>

<!-- åº•éƒ¨å ä½ï¼ˆé¿å… FAB é®æŒ¡å†…å®¹ï¼‰ -->
<view class="bottom-spacer"></view>

<!-- æ‚¬æµ®æ·»åŠ æŒ‰é’® -->
<view class="fab" bindtap="goToAdd">
  <text class="fab-icon">+</text>
</view>
