<!--pages/index/index.wxml-->

<!-- é¡µé¢æ ‡é¢˜ + æœˆä»½é€‰æ‹© -->
<view class="page-header">
  <text class="page-title">è®°è´¦æœ¬</text>
  <view class="month-selector">
    <view class="month-arrow" hover-class="month-arrow-hover" hover-stay-time="0" bindtap="prevMonth">â€¹</view>
    <picker mode="date" fields="month" value="{{pickerValue}}" bindchange="onDatePick">
      <text class="month-text">{{currentYear}}å¹´{{currentMonth}}æœˆ</text>
    </picker>
    <view class="month-arrow" hover-class="month-arrow-hover" hover-stay-time="0" bindtap="nextMonth">â€º</view>
  </view>
</view>

<!-- ä½™é¢å¡ç‰‡ -->
<view class="balance-card">
  <view class="balance-top">
    <text class="balance-label">æœ¬æœˆç»“ä½™ (å…ƒ)</text>
  </view>
  <text class="balance-amount">{{summary.balance < 0 ? '' : ''}}{{summary.balance}}</text>
  <view class="balance-row">
    <view class="balance-col">
      <text class="balance-sub-label">æ”¶å…¥</text>
      <text class="balance-sub-amount income-color">{{summary.income}}</text>
    </view>
    <view class="balance-col">
      <text class="balance-sub-label">æ”¯å‡º</text>
      <text class="balance-sub-amount expense-color">{{summary.expense}}</text>
    </view>
  </view>
</view>

<!-- å¿«æ·å…¥å£ -->
<view class="quick-actions">
  <view class="quick-item" bindtap="goToStats">
    <view class="quick-icon-wrap" style="background:#eef0fb;">
      <text class="quick-icon">ğŸ“Š</text>
    </view>
    <text class="quick-label">æŠ¥è¡¨</text>
  </view>
  <view class="quick-item" bindtap="goToRank">
    <view class="quick-icon-wrap" style="background:#fef4e6;">
      <text class="quick-icon">ğŸ†</text>
    </view>
    <text class="quick-label">æ’è¡Œ</text>
  </view>
  <view class="quick-item" bindtap="goToTrend">
    <view class="quick-icon-wrap" style="background:#e8f5e9;">
      <text class="quick-icon">ğŸ“ˆ</text>
    </view>
    <text class="quick-label">è¶‹åŠ¿</text>
  </view>
  <view class="quick-item" bindtap="goToAsset">
    <view class="quick-icon-wrap" style="background:#fde8e8;">
      <text class="quick-icon">ğŸ’°</text>
    </view>
    <text class="quick-label">èµ„äº§</text>
  </view>
</view>

<!-- è®°å½•åˆ—è¡¨ -->
<view class="record-list">
  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{isEmpty}}" class="empty-state">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— è®°å½•</text>
    <text class="empty-sub">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹è®°è´¦å§</text>
  </view>

  <!-- æŒ‰æ—¥æœŸåˆ†ç»„ -->
  <view wx:for="{{groupedRecords}}" wx:key="date" class="date-group">
    <view class="date-header">
      <text class="date-label">{{item.dateLabel}}</text>
    </view>

    <view class="records-card">
      <view
        wx:for="{{item.records}}"
        wx:for-item="record"
        wx:key="id"
        class="swipe-wrapper"
      >
        <view
          class="record-item"
          style="transform: translateX({{record.swipeOffset || 0}}px);"
          data-id="{{record.id}}"
          bindtouchstart="onTouchStart"
          bindtouchmove="onTouchMove"
          bindtouchend="onTouchEnd"
        >
          <view class="record-left">
            <view class="record-icon-wrap {{record.isIncome ? 'icon-bg-income' : 'icon-bg-expense'}}">
              <text class="record-icon">{{record.categoryIcon}}</text>
            </view>
            <view class="record-info">
              <text class="record-category">{{record.categoryLabel}}</text>
              <text class="record-note">{{record.note || record.date}}</text>
            </view>
          </view>
          <text class="record-amount {{record.isIncome ? 'income-color' : 'expense-color'}}">
            {{record.amountText}}
          </text>
        </view>
        <view class="delete-btn" data-id="{{record.id}}" bindtap="onDeleteRecord">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- åº•éƒ¨å ä½ -->
<view class="bottom-spacer"></view>

<!-- æ‚¬æµ®æ·»åŠ æŒ‰é’® -->
<view class="fab" bindtap="goToAdd">
  <text class="fab-icon">+</text>
</view>
